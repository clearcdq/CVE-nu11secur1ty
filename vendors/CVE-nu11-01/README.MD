## Description for `Simple Cafe Billing System` Vulnerability

The `Simple Cafe Billing System` with has no version number is vulnerable in the application `/cafe_billing/admin_class.php` from `remote SQL-Injection-Bypass-Authentication`. 
The parameter (username) from the login form is not protected correctly and there is no security and escaping from malicious payloads. 
When the user will sending a malicious query or malicious payload to the MySQL server he can bypass the login credentials and take control of the administer account.

## Vendor:
[href](https://www.sourcecodester.com/php/14569/simple-cafe-billing-system-using-phpmysqli-source-code.html)

![](https://github.com/nu11secur1ty/CVE-nu11secur1ty/blob/main/vendors/CVE-nu11-01/doc/Capture.PNG)

## Broken structure:
```php
	function login(){
		extract($_POST);		
		$qry = $this->db->query("SELECT * FROM users where username = '".$username."' and password = '".md5($password)."' ");
		if($qry->num_rows > 0){
			foreach ($qry->fetch_array() as $key => $value) {
				if($key != 'passwors' && !is_numeric($key))
					$_SESSION['login_'.$key] = $value;
			}
				return 1;
		}else{
			return 3;
		}
	}
 ```
---------------------------------------------------------------------------------------------------------------------

## Simple fix, but not enough `strong`!!!:
```php
	function login(){
		extract($_POST);		
		$qry = $this->db->query("SELECT * FROM users where username = ('$username') and password = '".md5($password)."' ");
		if($qry->num_rows > 0){
			foreach ($qry->fetch_array() as $key => $value) {
				if($key != 'passwors' && !is_numeric($key))
					$_SESSION['login_'.$key] = $value;
			}
				return 1;
		}else{
			return 3;
		}
	}
 ```
 
 ## Proof:
 [href](https://streamable.com/8ql92a)
 
 ## BR 
 - nu11secur1ty -_)
