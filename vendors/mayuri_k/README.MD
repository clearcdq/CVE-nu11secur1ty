## [CVE-nu11-16-092121](https://www.sourcecodester.com/php/14831/billing-system-project-php-source-code-free-download.html)

## Vendor is beautiful, but this is not enought ;) 

<p align="center">
  <img width="460" height="300" src="https://github.com/nu11secur1ty/CVE-nu11secur1ty/blob/main/vendors/mayuri_k/docs/picture-252843-1527103726.jpg">
</p>

----------------------------------------------------------------------------------------------------------------------------

![](https://github.com/nu11secur1ty/CVE-nu11secur1ty/blob/main/vendors/mayuri_k/docs/billing-system-project-in-php-source-code-free-download.jpg)

### Description:
The Â© 2021 Rupee Invoice System - Mayuri K | Designed by : Mayurik K is vulnerable from remote SQL-Injection-Bypass-Authentication. 
remote SQL-Injection-Bypass-Authentication: https://portswigger.net/support/using-sql-injection-to-bypass-authentication. 
The parameter (username) from the login form is not protected correctly and there is no security and escaping from malicious payloads. 
When the user will sending a malicious query or malicious payload to the MySQL server for those three accounts, he can bypass the login credentials and take control of admin account.

## Broken structure on `login.php` app:
```PHP
$errors = array();

if($_POST) {    

  $username = $_POST['username'];
  $password = $_POST['password'];

  if(empty($username) || empty($password)) {
    if($username == "") {
      $errors[] = "Username is required";
    } 

    if($password == "") {
      $errors[] = "Password is required";
    }
  } else {
    $sql = "SELECT * FROM users WHERE username = ('$username')";
    $result = $connect->query($sql);

    if($result->num_rows == 1) {
      $password = md5($password);
      // exists
      $mainSql = "SELECT * FROM users WHERE username = '$username' AND password = '$password'";
      $mainResult = $connect->query($mainSql);

      if($mainResult->num_rows == 1) {
        $value = $mainResult->fetch_assoc();
        $user_id = $value['user_id'];

        // set session
        $_SESSION['userId'] = $user_id;?>
```
## Simple fixed, but not enough ;)
![](https://github.com/nu11secur1ty/CVE-nu11secur1ty/blob/main/vendors/mayuri_k/docs/fixhaha.gif)

## Decision:
[href](https://www.nu11secur1ty.com/2021/08/php-sec-login.html)

## BR
